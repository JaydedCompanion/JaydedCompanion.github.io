
<html>

    <head>

        <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0"/><link rel="stylesheet" href="airconsole-controls/button/button.css">

        <link rel="stylesheet" href="airconsole-controls/dpad/dpad.css">

        <link rel="stylesheet" href="airconsole-controls/joystick/joystick.css">

        <link rel="stylesheet" href="airconsole-controls/ctrl-generator/controller.css">

    </head>

    <body>

    
        <div class="gamepad_container">
      
            <div id="left" class="left"></div>
      
            <div id="middle" class="middle"></div>
      
            <div id="right" class="right"></div>
    
        </div>
        
        <div style="display: none;">
            
            <div id="template-DPad">
        
                <div>
          
                    <div class="dpad-arrow dpad-arrow-up"></div>
          
                    <div class="dpad-arrow dpad-arrow-down"></div>
          
                    <div class="dpad-arrow dpad-arrow-left"></div>
          
                    <div class="dpad-arrow dpad-arrow-right"></div>
        
                </div>
      
            </div>
      
            <div id="template-DPadRelative">
        
                <div>
          
                    <div class="dpad-instructions">SWIPE</div>
          
                    <div class="dpad-arrow dpad-arrow-up"></div>
          
                    <div class="dpad-arrow dpad-arrow-down"></div>
          
                    <div class="dpad-arrow dpad-arrow-left"></div>
          
                    <div class="dpad-arrow dpad-arrow-right"></div>
        
                </div>
      
            </div>
      
            <div id="template-Joystick" class="joystick">
        
                <div class="joystick-relative">
          
                    <div class="joystick-relative-stick"></div>
        
                </div>
      
            </div>

      
            <div id="template-SwipeDigital" class="button-300-300 swipe-area">
        
                <div class="button-text">SWIPE</div>
      
            </div>
      
            <div id="template-SwipeAnalog" class="button-300-300 swipe-area">
        
                <div class="button-text">SWIPE</div>
      
            </div>
      
            <div id="template-SwipePattern" class="swipe-pattern-container"></div>
      
            <div id="template-ButtonVertical" class="button-300-150"><div class="button-text"></div></div>
      
            <div id="template-ButtonMiddle" class="button-80"><div class="button-text">START</div></div>
            
        </div>
        
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
        
        <script type="text/javascript" src="https://www.airconsole.com/api/airconsole-1.3.0.js"></script>
        <script type="text/javascript" src="airconsole-controls/rate-limiter/rate-limiter.js"></script>
        <script type="text/javascript" src="airconsole-controls/dpad/dpad.js"></script>
        <script type="text/javascript" src="airconsole-controls/joystick/joystick.js"></script>
        <script type="text/javascript" src="airconsole-controls/button/button.js"></script>
        <script type="text/javascript" src="airconsole-controls/swipe-digital/swipe-digital.js"></script>
        <script type="text/javascript" src="airconsole-controls/swipe-analog/swipe-analog.js"></script>
        <script type="text/javascript" src="airconsole-controls/swipe-pattern/swipe-pattern.js"></script>
        <script type="text/javascript" src="airconsole-controls/ctrl-generator/ctrl-generator.js"></script>
        
        <!-- <script type="text/javascript" src="tinter.js"></script> -->
        
        <script type="text/javascript">
            
            // Sets the background of an element
            function setElementImg(element, url) {
                element.css("background-image", url);
            }
            
            var airconsole = new AirConsole({orientation: AirConsole.ORIENTATION_LANDSCAPE});
            
            //Assign Hue of Coloured Highlights According to Message
            
            airconsole.onMessage = function (device_id, data) {
                
                console.log (data);
                    
                var big_button_elements = $(".undefined");

                var joystick_element = $(".joystick-relative-stick");

                var PlayerID;
                var PlayerID_Prev;
                var OnStartSprite;
                
                var imgURL;
                
                var DisectedData = "";
                var DataString = data.toString();
                var DataBits = DataString.split(".");
                
                if (DataBits[0] === "DeviceRegister" && DataBits[1] === "Ping") {
                    
                    console.log("Received device register ping request from screen");
                    
                    airconsole.message (
                        device_id, 
                        ({
                            "DeviceRegister": "PingReply"
                        })
                    );
                    
                } else if (DataBits[0] === "PlayerID") {
                    
                    PlayerID_Prev = PlayerID;
                    
                    PlayerID = DataBits[1];
                    
                }
                
                //Detect delta differences in the playerID
                if (PlayerID != PlayerID_Prev) {
                    
                    OnStartSprite = true;
                    
                }
                    
                if (PlayerID == 0) {
                    
                    if (OnStartSprite) {
                        
                        imgURL = 'url(airconsole-controls/button/button-300-300.6.png)';
                        
                        OnStartSprite = false;
                        
                    }

                    console.log("Player ID is 0, will set to default");

                    // Set active image when somone touches the element
                    big_button_elements.on('mousedown touchstart', function() {
                        imgURL = 'url(airconsole-controls/button/button-300-300-active.6.png)';
                    });

                    // Back to default:
                    big_button_elements.on('mouseup touchend', function() {
                        imgURL = 'url(airconsole-controls/button/button-300-300.6.png)';
                    });

                    // update img:
                    big_button_elements.on('mousedown touchstart mouseup touchend', function() {
                        setElementImg(big_button_elements, imgURL);
                    });

                    joystick_element.css("background-image", 'url(airconsole-controls/joystick/joystick-stick.6.png)');

                } else if (PlayerID == 100) {
                    
                    if (OnStartSprite) {
                        
                        imgURL = 'url(airconsole-controls/button/button-300-300.select.png)';
                        
                        OnStartSprite = false;
                        
                    }
                    
                    //Code player 100 means that the current controller is in charge of selecting the mode and length of the game

                    console.log("Player ID is 100, will set to master sprites");

                    // Set active image when somone touches the element
                    big_button_elements.on('mousedown touchstart', function() {
                        imgURL = 'url(airconsole-controls/button/button-300-300-active.select.png)';
                    });

                    // Back to default:
                    big_button_elements.on('mouseup touchend', function() {
                        imgURL = 'url(airconsole-controls/button/button-300-300.select.png)';
                    });

                    // update img:
                    big_button_elements.on('mousedown touchstart mouseup touchend', function() {
                        setElementImg(big_button_elements, imgURL);
                    });

                    joystick_element.css("background-image", 'url(airconsole-controls/joystick/joystick-stick.png)');
                    
                } else if (PlayerID >= 1 && PlayerID <= 6) {
                    
                    if (OnStartSprite) {
                        
                        imgURL = 'url(airconsole-controls/button/button-300-300.' + PlayerID + '.png)';
                        
                        OnStartSprite = false;
                        
                    }

                    // Set active image when somone touches the element
                    big_button_elements.on('mousedown touchstart', function() {
                        imgURL = 'url(airconsole-controls/button/button-300-300-active.' + PlayerID + '.png)';
                    });

                    // Back to default:
                    big_button_elements.on('mouseup touchend', function() {
                        imgURL = 'url(airconsole-controls/button/button-300-300.' + PlayerID + '.png)';
                    });

                    // update img:
                    big_button_elements.on('mousedown touchstart mouseup touchend', function() {
                        setElementImg(big_button_elements, imgURL);
                    });

                    joystick_element.css("background-image", 'url(airconsole-controls/joystick/joystick-stick.' + PlayerID + '.png)');

                }
                
                setElementImg(big_button_elements, imgURL);
                
                if (DataBits[0] == "RGB") {
                    
                    console.log("Using color values is now deprecated. Please send a played ID instead");
                    
//                    
//                    //Separate the different components of the message data
//
//                    for (i = 0; i < DataBits.length; i ++) {
//                        DisectedData += DataBits[i] + ", ";
//                    }
//                
//                    console.log (("Original: " + DataString + ", Disected: " + DisectedData));
//            
//                    var button_elements = $(".button-300-150");
//                    var big_button_elements = $(".undefined");
//                    var joystick_element =  $(".joystick");
//                    
//                    var R = DataBits[1];
//                    var G = DataBits[2];
//                    var B = DataBits[3];
//
//                    big_button_elements.css("background-color", "rgba(" + R + "," + G + "," + B + ")");
//
//                    button_elements.css("background-color", "rgba(" + R + "," + G + "," + B + ")");
//
//                    joystick_element.css("background-color", "rgba(" + R + "," + G + "," + B + ")");
//                    
                }
                
            }

            CtrlGenerator.setAirConsole(airconsole);

            CtrlGenerator.generate({"left":{"type":{"label":"Joystick","class_name":"Joystick"}},"middle":[{"label":"","key":"R"},{"label":"","key":"| |"}],"right":[{"type":{"label":"ButtonVertical","class_name":"Button"},"label":"","key":"attack","on_up_message":true}]});

        </script>
        
    </body>

</html>